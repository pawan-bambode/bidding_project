
<%- include('../partials/head') %>
<%- include('../partials/leftSidebar.ejs') %>
<%- include('../partials/header.ejs') %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<div class="main-content">
    <div class="col-12">
        <div class="breadcrumb" style="margin: 10px 0;">
            <a style="text-decoration: none; color: #007bff; font-weight: bold;" href="javascript:void(0)">Courseworkload</a>
            <i class="fa fa-home" aria-hidden="true" style="margin: 0 5px;"></i>
            <a href="javascript:void(0)" style="text-decoration: none;">Courseworkload</a>
        </div>
    </div>

    <div class="card card-custom" >
        <div class="card-header-custom d-flex justify-content-between p-2">
            <h4 class="ms-2">Course Data</h4>
            <button type="button" class="btn btn-success me-2"  data-bs-target="#upload-course-modal" data-bs-toggle="modal">Upload Courses</button>
        </div>
        <div class="card-body table-responsive" id="course-table">
            <table class="table custom_row table-bordered mt-4">
                <thead>
                  <tr>
                    <th>id</th>
                    <th>Course Name</th>
                    <th>Credit</th>
                    <th>Program Id</th>
                    <th>Acad Session</th>
                    <th>Area</th>
                  </tr>
                </thead>
                <tbody>
                  
                </tbody>
              </table>
        </div>
    </div>
    <div class="modal" id="upload-course-modal" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
         
            <div class="modal-header">
              <h5 class="modal-title">Upload Courses</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <div class="modal-body">
                    <div class="d-flex">
                    <label class="form-label me-3">Import Courses :</label>
                    <form enctype="multipart/form-data" action="/admin/upload-course" method="post">
                    <input type="file" name="excel-file" id="import-course" accept=".xlsx">
                
                    </div>
                    <div class="d-flex justify-content-between align-item-center mt-5">
                    <input type="submit" class="btn btn-success mt-2 d-none" id="upload-course-button" value="Upload Courses"></input> 
                    </form> 
                
                  <a href="/admin/generate-excel" download="sampleForImportCourse.xlsx" name="sample-for-import-course" class="text-decoration-none align-self-end">Sample For Import Course</a>
                 </div>
             
            </div>
      
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
           
          </div>
        </div>
      </div>
      
<script>
   $(document).ready(function(){
     $('#import-course').on('change', function(){
        let importCourse = $(this).val();
        if(importCourse != ''){
            $('#upload-course-button').removeClass('d-none');
        }
      });

     $('#upload-course-button').on('click',function(){
      let importCourseFileName = $('#import-course').val();
         let ApiObj = {
             type:'POST',
             url:'/admin/upload-course',
             data:{
              fileName:importCourseFileName
             },
             dataType:'JSON'
             }
             ajaxApi(ApiObj).then(result =>{
             console.log('values of result',result);
             showSuccess(result);
             }).catch(error =>{
             console.log('values of error',error);
             showError(error.responseJson);
             })
     })
   })
</script>
<%- include('../partials/footer.ejs') %>
<%- include('../partials/footerEnd.ejs') %>

