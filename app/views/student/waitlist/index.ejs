<%- include('../partials/head') %>

<%- include('../partials/leftSidebarForStudent.ejs') %>
<%- include('../partials/header.ejs') %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<div class="main-content">
  <div class="card card-custom-border-curv">
    <div class="card-header-custom d-flex justify-content-between p-1">
        <h3 class="ms-2">Wait List</h3>  
    </div>
    <div class="card-body table-responsive">    
      <div class="row ps-5 pe-5">
        <div class="col-md-4">
            <h6>Total Bid Points :&nbsp;<span id="total-bid-points"> <%- studentBidsPoints.student_bid_points %></span></h6>
        </div>    
        <div class="col-md-4">
            <h6>Remaining Bid Points :&nbsp;<span id="remaining-bid-points"><%- remaingBidPoints.student_bid_points %></h6>
        </div>
        <div class="col-md-4">
            <h6>Credits Winning : &nbsp;<span id="credits-winning"></span></h6>
        </div>
    </div>
      <div class="row ps-5 pe-5">
        <%for(let credit of creditList) { %>
            <div class="col-md-4">
                <h6><%- credit.acad_session %> Credits :&nbsp;<span class="credits-point-target" id="credits-points-target-<%- credit.sap_acad_session_id %>" data-id="<%-credit.sap_acad_session_id %>"></span></h6>
            </div>
        <% } %>
    </div>
  
    <div class="row ps-5 pe-5">
            <%for(let acadSession of dropdownAcadSessionList) { %>
                <div class="col-md-4">
                    <h6><%- acadSession.acad_session %> Selected Credits :&nbsp;<span class="current-credit-points" data-id="<%- acadSession.sap_acad_session_id %>" id="credits-points-<%- acadSession.sap_acad_session_id %>">0</span></h6>
                </div>
            <% } %>
    </div>

    <div class="row ps-5 pe-5">
        <div class="col-md-4">
            <h6>Start Time :&nbsp;<span id="start-time"><%-startAndEndTime.startTime %></span></h6>
        </div>    
        <div class="col-md-4">
            <h6>End Time :&nbsp;<span id="end-time"><%-startAndEndTime.endTime %></h6>
        </div>
        <div class="col-md-4">
            <h6>Current Time : &nbsp;<span id="current-date-time"></span></h6>
        </div>
    </div>
    </div>
  </div>

  <div class="card card-custom-border-curv mt-5">
    <div class="card-header-custom d-flex justify-content-between p-1">
        <h3 class="ms-2">Confirmation Courses</h3>  
    </div>
    <div class="card-body table-responsive">
     
    </div>
  </div>
  <div class="card card-custom-border-curv mt-5">
    <div class="card-header-custom d-flex justify-content-between p-1">
        <h3 class="ms-2">Bidding Course</h3>  
    </div>
    <div class="col-md-3 mt-4 ms-5">
      <select class="form-select form-control select2 d-none" id="bidding-acad-session-filter">
        <option value="" selected>Select Acad Session</option>
        <option value="1">Select All</option>
        <option value="34">Trimester IV</option>
        <option value="35">Trimester V</option>
        <option value="36">Trimester VI</option>
        
      </select>
     </div>
    <div class="card-body table-responsive">
      <table class="table custom_row table-bordered mt-4 custom-table" id="bidding-table">
        <thead>
            <th>#</th>
            <th>Area</th>
            <th>Course</th>
            <th>Acad Session</th>
            <th>Faculty</th>
            <th>Credits</th>
            <th>Available Seats</th>
            <th>Total Bidders</th>
            <th>MRB</th>
            <th>Winning status</th>
            <th>Your Bid</th>
            <th>Change Bid</th>
            <th>Withdraw</th>
        </thead>
        <tbody>
          <% let count = 1; %>
          <% considerationSetList.forEach((considerationSet) => { %>
             
            <tr 
            data-id= "<%= considerationSet.id %>" data-division-batch-lid = "<%- considerationSet.div_batch_lid %>"
            data-area-name = "<%- considerationSet.area_name %>" data-course-name = "<%- considerationSet.course_name %>" data-acad-session = "<%- considerationSet.acad_session %>"  data-round-lid ="<%- considerationSet.round_lid %>"
            data-faculty-id = "<%- considerationSet.faculty_id %>" data-faculty-name="<%- considerationSet.faculty_name %>" data-course-time="<%-considerationSet.faculty_date_time %>" data-credits = "<%- considerationSet.credits %>" 
            
            data-max-seats ="<%- considerationSet.available_seats %>" data-course-time ="${courseTime}" data-acad-session-id = "<%- considerationSet.sap_acad_session_id %>" data-course-id ="<%- considerationSet.course_id %>" data-course-lid="<%- considerationSet.course_lid %>">
              <td class="id-column"><%= count++ %></td>
              <td><%= considerationSet.area_name %></td>
              <td><%= considerationSet.course_name %>-<%= considerationSet.division %></td>
              <td><%= considerationSet.acad_session %></td>
              <td><%= considerationSet.faculty_name %></td>
              <td><%= considerationSet.credits %></td>
              <td class="available-count"><%= considerationSet.available_seats %></td>
                        <td class="total-bidder-counts"><%= considerationSet.total_bidders %></td>
                        <td class="mrb-points"><%= considerationSet.min_req_bid %></td>
                        <% if (considerationSet.is_winning) { %>
                          <td class="winning-status winning">Yes</td>
                        <% } else { %>
                          <td class="winning-status losing">No</td>
                         <% } %>
                        <td class="student-previous-bid-point"><%= considerationSet.bid_points %></td>
                        <td class="d-flex"><input type="text" placeholder="Bids" class="p-2 student-current-bid-point" size='15'>
                          <button class="btn border border-dark ms-2 add-bidding-points">
                          <img src='/image/student/body-part-image/bidding-round-image/check-mark.png' alt='checkmark'>
                          </button> </td>
                        <td>
                          <button class="btn border border-danger withdraw-bidding mt-1" data-area="${areaName}"><img src='/image/student/body-part-image/bidding-round-image/withdraw.png' </button></td>
            </tr>
          <% }); %>    
        </tbody>
     </table>
    </div>
  </div>
  
  <div class="card card-custom-border-curv mt-5 bidding-modal" id="bidding-modal">
    <div class="card-header-custom d-flex justify-content-between p-1">
        <h3 class="ms-2">Available Courses</h3>
    </div>
 
    <div class="card-body table-responsive">
        <div class="d-flex">
          <% for(let acadSession of dropdownAcadSessionList) { %>
            <div class="col-sm-4 p-2">
              <button class="btn btn-light w-100 border bidding-trimester bidding-trimester-selected"  data-acad-session-id = "<%- acadSession.sap_acad_session_id %>">
                <%-acadSession.acad_session %>
              </button>
            </div>
          <% } %>
        </div> 
        
       <div class="row">
          <div class="col-md-3 mt-4 ms-2">
            <select class="form-select form-control select2 d-none" id="area-filter">
              <option value="" selected>Select Area</option>
              <option value="All">Select All Areas</option>
              <% for(let area of areaList) { %>
                <option value="<%-area.area_name %>" ><%-area.area_name %></option>
              <% } %>
            </select>
         </div>
          <div class="col-md-3 mt-4 ms-2">
              <select class="form-select form-control select2 d-none" id="course-filter">
                <option value="" selected>Select Course</option>
                <option value="All">Select All Courses</option>
                
                <% for(let biddingCourse of courseList) { %>
                  <option value="<%-biddingCourse.course_id %>" ><%-biddingCourse.course_name %></option>
                <% } %>
              </select>
          </div>
        </div>
        
        <table class="table custom_row table-bordered mt-4 custom-table" id="bidding-trimester-select-table">
            <thead>
                <th>#</th>
                <th>Area</th>
                <th>Course</th>
                <th>Trimester</th>
                <th>Course Timings</th>
                <th>Credits</th>
                <th>Available Seats</th>
                <th>Total Bidders</th>
                <th>MRB</th>
                <th>Action</th>
            </thead>
            <tbody>     
         </table>
  </div>
</div>
<footer class="footer">
  <div class="footer-div">
      <div class="d-flex justify-content-center align-items-center" style="height: 40px;">
          <div class="d-flex justify-content-between align-items-center">
           <button class="btn btn-success text-light">Remaining Bid Points:&nbsp;<span id="remaining-bid-points"></button>
          </div>
      </div>
  </div>
</footer>
<script>
$(document).ready(function() {
    let active = `<%- active %>`;
    $('#sidebar .side-menu li.' + active).addClass('active');
});

</script>

<%- include('../partials/footer.ejs') %>

<%- include('../partials/footerEnd.ejs') %>